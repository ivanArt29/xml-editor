# XML Editor (PyQt5)

Офлайн‑редактор XML на PyQt5 с деревом элементов, подсветкой синтаксиса, поиском/заменой и экспортом в HTML/PDF.

## Возможности
- Открытие/сохранение XML; дерево с ленивой подгрузкой
- Подсветка синтаксиса XML
- Поиск/замена (plain text; «Регистр», «Целое слово»)
- Экспорт: HTML, PDF; печать

## Системные требования

### Минимальные требования
- **Операционная система**: Windows 10/11, Linux (Ubuntu 18.04+), macOS 10.14+
- **Python**: версия 3.11 или выше
- **ОЗУ**: минимум 512 МБ (рекомендуется 1 ГБ)
- **Дисковое пространство**: 100 МБ для установки
- **Разрешение экрана**: 1024x768 (рекомендуется 1280x720 или выше)

### Поддерживаемые платформы
- Windows 10/11 (x64)
- Ubuntu 18.04+ / Debian 10+
- CentOS 7+ / RHEL 7+
- macOS 10.14+ (Intel и Apple Silicon)
- Arch Linux
- Fedora 30+

## Подробная инструкция по установке

### Шаг 1: Установка Python

#### Windows
1. **Скачайте Python**:
   - Перейдите на [python.org](https://www.python.org/downloads/)
   - Скачайте Python 3.11+ для Windows (рекомендуется последняя стабильная версия)
   - Выберите "Windows installer (64-bit)" для современных систем

2. **Установите Python**:
   - Запустите скачанный `.exe` файл
   - **ВАЖНО**: Отметьте галочку "Add Python to PATH" внизу окна установщика
   - Выберите "Install Now" для стандартной установки
   - Дождитесь завершения установки

3. **Проверьте установку**:
   - Откройте командную строку (Win+R → cmd)
   - Выполните команду: `python --version`
   - Должна отобразиться версия Python 3.11 или выше

#### Linux (Ubuntu/Debian)
```bash
# Обновление списка пакетов
sudo apt update

# Установка Python 3.11+ и pip
sudo apt install python3.11 python3.11-pip python3.11-venv

# Проверка установки
python3.11 --version
pip3.11 --version
```

#### Linux (CentOS/RHEL)
```bash
# Установка EPEL репозитория
sudo yum install epel-release

# Установка Python 3.11+ и pip
sudo yum install python3.11 python3.11-pip

# Проверка установки
python3.11 --version
pip3.11 --version
```

#### macOS
1. **Установка через Homebrew** (рекомендуется):
   ```bash
   # Установка Homebrew (если не установлен)
   /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
   
   # Установка Python
   brew install python@3.11
   
   # Проверка установки
   python3.11 --version
   ```

2. **Установка через официальный сайт**:
   - Скачайте установщик с [python.org](https://www.python.org/downloads/macos/)
   - Запустите `.pkg` файл и следуйте инструкциям

### Шаг 2: Подготовка рабочей директории

1. **Создайте папку для проекта**:
   ```bash
   # Windows (PowerShell)
   mkdir C:\xml-editor
   cd C:\xml-editor
   
   # Linux/macOS
   mkdir ~/xml-editor
   cd ~/xml-editor
   ```

2. **Скачайте файлы проекта**:
   - Скопируйте все файлы проекта в созданную папку
   - Убедитесь, что все файлы находятся в одной директории

### Шаг 3: Создание виртуального окружения (рекомендуется)

#### Windows
```cmd
# Создание виртуального окружения
python -m venv .venv

# Активация виртуального окружения
.venv\Scripts\activate

# Проверка активации (в командной строке должен появиться префикс (.venv))
```

#### Linux/macOS
```bash
# Создание виртуального окружения
python3.11 -m venv .venv

# Активация виртуального окружения
source .venv/bin/activate

# Проверка активации (в терминале должен появиться префикс (.venv))
```

### Шаг 4: Установка зависимостей

1. **Убедитесь, что виртуальное окружение активно**:
   - Windows: `(.venv)` должно быть в начале командной строки
   - Linux/macOS: `(.venv)` должно быть в начале терминала

2. **Обновите pip до последней версии**:
   ```bash
   python -m pip install --upgrade pip
   ```

3. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Проверьте установку**:
   ```bash
   pip list
   ```
   Должны быть установлены:
   - PyQt5==5.15.9
   - pytest==8.3.2
   - pytest-qt==4.4.0
   - mypy==1.11.1

### Шаг 5: Запуск программы

1. **Запустите XML Editor**:
   ```bash
   python main.py
   ```

2. **Проверьте работу**:
   - Должно открыться главное окно программы
   - Попробуйте открыть файл XML через меню "Файл" → "Открыть"
   - Используйте прилагаемый `Sample.xml` для тестирования

### Шаг 6: Настройка (опционально)

1. **Настройки внешнего вида**:
   - Перейдите в меню "Настройки" → "Настройки"
   - Настройте шрифт, размер, цвета по своему усмотрению
   - Настройки сохраняются в файл `app_settings.ini`

2. **Настройка горячих клавиш**:
   - Ctrl+O - Открыть файл
   - Ctrl+S - Сохранить файл
   - Ctrl+F - Поиск
   - Ctrl+H - Замена
   - Ctrl+Z - Отмена
   - Ctrl+Y - Повтор

## Решение проблем

### Проблема: "python не является внутренней или внешней командой"
**Решение**: Python не добавлен в PATH
1. Переустановите Python с галочкой "Add Python to PATH"
2. Или добавьте Python в PATH вручную через "Переменные среды"

### Проблема: "ModuleNotFoundError: No module named 'PyQt5'"
**Решение**: Зависимости не установлены
1. Убедитесь, что виртуальное окружение активно
2. Выполните: `pip install -r requirements.txt`

### Проблема: "Permission denied" на Linux/macOS
**Решение**: Недостаточно прав
1. Используйте `sudo` для установки системных пакетов
2. Для pip используйте `--user` флаг: `pip install --user -r requirements.txt`

### Проблема: Программа не запускается на macOS
**Решение**: Проблемы с разрешениями
1. Разрешите выполнение в "Системные настройки" → "Безопасность и конфиденциальность"
2. Или запустите через терминал: `python3.11 main.py`

### Проблема: Ошибки с кодировкой на Windows
**Решение**: Проблемы с кодировкой
1. Установите переменную среды: `set PYTHONIOENCODING=utf-8`
2. Или используйте PowerShell вместо cmd

## Тестирование

### Запуск тестов
```bash
# Убедитесь, что виртуальное окружение активно
pytest -q

# Для подробного вывода
pytest -v

# Запуск конкретного теста
pytest test_editor.py::test_function_name
```

### Проверка типов (mypy)
```bash
mypy main.py
mypy tree_builder.py
mypy syntax_highlighter.py
```

## Структура проекта

```
xml-editor/
├── main.py                 # Главное окно приложения
├── tree_builder.py         # Построение дерева XML (многопоточность)
├── syntax_highlighter.py   # Подсветка синтаксиса XML
├── file_loader.py          # Загрузка файлов в отдельном потоке
├── exporter.py             # Экспорт в HTML/PDF
├── settings_dialog.py      # Диалог настроек
├── test_editor.py          # Тесты приложения
├── requirements.txt        # Зависимости Python
├── app_settings.ini        # Настройки приложения
├── Sample.xml             # Пример XML файла
└── README.md              # Документация
```

## Дополнительная информация

### Поддерживаемые форматы
- **Входные**: XML файлы любого размера
- **Выходные**: HTML, PDF, печать

### Производительность
- Поддержка больших XML файлов через ленивую загрузку дерева
- Многопоточная обработка для предотвращения зависания UI
- Оптимизированная подсветка синтаксиса

### Безопасность
- Валидация XML при открытии файлов
- Безопасная обработка ошибок парсинга
- Изоляция в виртуальном окружении

## Поддержка

При возникновении проблем:
1. Проверьте версию Python: `python --version`
2. Убедитесь, что все зависимости установлены: `pip list`
3. Проверьте логи ошибок в консоли
4. Убедитесь, что файл XML валиден

## Лицензия

Проект распространяется свободно для образовательных и коммерческих целей.

## Автор
Выполнено Артемовым И.А.
